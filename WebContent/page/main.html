<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="author" content="Chomo" />
<title>后台管理</title>

<script src="../js/jquery/jquery-3.1.1.min.js"></script>
<script src="../js/vue/vue.min.js"></script>

<link rel="stylesheet" type="text/css" href="../css/accordion.css" />
<script src="../js/accordion.js"></script>

<link rel="stylesheet" type="text/css" href="../component/tether-1.3.3/css/tether.min.css" />
<script src="../component/tether-1.3.3/js/tether.min.js"></script>

<link rel="stylesheet" type="text/css" href="../component/bootstrap-4.0.0-alpha.6-dist/css/bootstrap.min.css" />
<script src="../component/bootstrap-4.0.0-alpha.6-dist/js/bootstrap.min.js"></script>

<link rel="stylesheet" type="text/css" href="../component/bootstrap-table-1.11.1/bootstrap-table.min.css" />
<script src="../component/bootstrap-table-1.11.1/bootstrap-table.min.js"></script>
<!-- <link rel="stylesheet" href="http://cdnjs.cloudflare.com/ajax/libs/bootstrap-table/1.11.1/bootstrap-table.min.css"/>
<script src="http://cdnjs.cloudflare.com/ajax/libs/bootstrap-table/1.11.1/bootstrap-table.min.js"></script>
<script src="http://cdnjs.cloudflare.com/ajax/libs/bootstrap-table/1.11.1/locale/bootstrap-table-zh-CN.min.js"></script> -->

<script src="../js/request-url.js"></script>

<script>
	var successCode = 0;
	$(document).ready(function() {
		$.post(ajaxUrl.privilege, function(data) {
			data = JSON.parse(data);
			if (data.code == successCode) {
				data.object.forEach(function(value){
					if (1 == value) {
						mainData.restaurantManage.visiable = true;
						mainData.restaurantManage.userManage.visiable = true;
					}
					if (2 == value) {
						mainData.restaurantManage.visiable = true;
						mainData.restaurantManage.roleManage.visiable = true;
					}
					if (4 == value) {
						mainData.restaurantManage.visiable = true;
						mainData.restaurantManage.tableManage.visiable = true;
					}
					if (3 == value) {
						mainData.restaurantManage.visiable = true;
						mainData.restaurantManage.foodManage.visiable = true;
					}
					if (5 == value) {
						mainData.systemManage.visiable = true;
						mainData.systemManage.restaurantManage.visiable = true;
					}
					if (6 == value) {
						mainData.systemManage.visiable = true;
						mainData.systemManage.restaurantManagerManage.visiable = true;
					}
				})
			} else {
				alert("权限获取失败:" + data.msg);
			}
		});
	});
</script>
</head>
<body>
	<div id="page">
		<div id="top">
			<p id="account">hello,{{ account }}</p>
		</div>

		<div id="left">
			<div id="divMenu">
				<ul id="accordion" class="accordion">
					<li v-if="systemManage.visiable">
						<div class="link">
							系统管理
						</div>
						<ul class="submenu">
						<li><a v-on:click="loadPage('system-manage/restaurant-manage.html')"
								v-if="systemManage.restaurantManage.visiable">餐厅管理</a></li>
						</ul>
					</li>
					<li v-if="restaurantManage.visiable">
						<div class="link">
							餐厅管理
						</div>
						<ul class="submenu">
						<li><a v-on:click="loadPage('restaurant-manage/user-manage.html')"
								v-if="restaurantManage.userManage.visiable">用户管理</a></li>
							<li><a v-on:click="loadPage('restaurant-manage/role-manage.html')"
								v-if="restaurantManage.roleManage.visiable">角色管理</a></li>
							<li><a v-on:click="loadPage('restaurant-manage/seat-manage.html')"
								v-if="restaurantManage.tableManage.visiable">席位管理</a></li>
							<li><a v-on:click="loadPage('common/error.html')"
								v-if="restaurantManage.foodManage.visiable">菜品管理</a></li>
						</ul>
					</li>
				</ul>
			</div>
		</div>

		<div id="right" class="right">
			<script>
				/* $('#right').load("../index.html"); */
			</script>
		</div>


		<div id="bottom"></div>
	</div>
</body>


<script>
	//top上账号信息显示
	var mainData = new Vue({
		el : '#page',
		data : {
			account : getParam("account"),
			systemManage : {
				visiable : false,
				restaurantManage : {
					visiable : false
				},
				restaurantManagerManage : {
					visiable : false
				}
			},
			restaurantManage : {
				visiable : false,
				userManage : {
					visiable : false
				},
				roleManage : {
					visiable : false
				},
				tableManage : {
					visiable : false
				},
				foodManage : {
					visiable : false
				}
			}
		},

		mounted : function() {
			// `this` 指向 vm 实例
		},
		updated : function() {
			// `this` 指向 vm 实例
			var accordion = new Accordion($('#accordion'), false);

		},

		methods : {
			loadPage : function(uri) {
				$('#right').load(uri);
			}
		},

	});
	function getParam(paramName) {
		paramValue = "";
		isFound = false;
		if (this.location.search.indexOf("?") == 0
				&& this.location.search.indexOf("=") > 1) {
			arrSource = unescape(this.location.search).substring(1,
					this.location.search.length).split("&");
			i = 0;
			while (i < arrSource.length && !isFound) {
				if (arrSource[i].indexOf("=") > 0) {
					if (arrSource[i].split("=")[0].toLowerCase() == paramName
							.toLowerCase()) {
						paramValue = arrSource[i].split("=")[1];
						isFound = true;
					}
				}
				i++;
			}
		}
		return paramValue;
	};
</script>





<style type="text/css">
* {
	margin: 0;
	padding: 0;
	list-style: none;
}

html {
	height: 100%;
	overflow: hidden;
	background: #fff;
}

body {
	height: 100%;
	overflow: hidden;
	background: #fff;
}

div {
	line-height: 1.6;
}

#top {
	position: absolute;
	top: 10px;
	height: 50px;
	background: #2d2c41;
	width: 100%
}

#left {
	position: absolute;
	top: 70px;
	bottom: 0px;
	width: 200px;
	overflow: auto;
	padding-right: 2px;
	background: #2d2c41;
}

#right {
	position: absolute;
	left: 210px;
	top: 70px;
	bottom: 0px;
	right: 0px;
	overflow: auto;
	background: #FFFAFA
}

#bottom {
	position: absolute;
	left: 0px;
	bottom: 0px;
	right: 0px;
	height: 0px;
}

#account {
	color: #fff;
}
</style>
</html>